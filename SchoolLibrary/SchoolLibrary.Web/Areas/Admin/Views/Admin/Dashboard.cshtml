@model SchoolLibrary.Web.Models.ViewModels.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
}

<div class="content-box">
    <h2 class="mb-4">üè† Dashboard - Qu·∫£n tr·ªã h·ªá th·ªëng</h2>

    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card border-primary">
                <div class="card-body text-center">
                    <h1 class="text-primary">@Model.TotalUsers</h1>
                    <p class="mb-0">T·ªïng ng∆∞·ªùi d√πng</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card border-success">
                <div class="card-body text-center">
                    <h1 class="text-success">@Model.TotalBooks</h1>
                    <p class="mb-0">T·ªïng s√°ch</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card border-warning">
                <div class="card-body text-center">
                    <h1 class="text-warning">@Model.TotalBorrowedBooks</h1>
                    <p class="mb-0">S√°ch ƒëang m∆∞·ª£n</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card border-info">
                <div class="card-body text-center">
                    <h1 class="text-info">@Model.TotalCategories</h1>
                    <p class="mb-0">Th·ªÉ lo·∫°i</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-4 mb-3">
            <div class="card border-success">
                <div class="card-body text-center">
                    <h3 class="text-success">@Model.ActiveUsers</h3>
                    <p class="mb-0">Ng∆∞·ªùi d√πng ho·∫°t ƒë·ªông</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card border-danger">
                <div class="card-body text-center">
                    <h3 class="text-danger">@Model.InactiveUsers</h3>
                    <p class="mb-0">Ng∆∞·ªùi d√πng kh√¥ng ho·∫°t ƒë·ªông</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card border-secondary">
                <div class="card-body text-center">
                    <h3 class="text-secondary">@DateTime.Now.ToString("dd/MM/yyyy")</h3>
                    <p class="mb-0">H√¥m nay</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 mb-3">
            <div class="card">
                <div class="card-header">
                    <h5>üë• Ng∆∞·ªùi d√πng m·ªõi nh·∫•t</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>ID</th>
                                    <th>H·ªç t√™n</th>
                                    <th>T√™n ƒëƒÉng nh·∫≠p</th>
                                    <th>Vai tr√≤</th>
                                    <th>Email</th>
                                    <th>Tr·∫°ng th√°i</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var user in Model.RecentUsers!)
                                {
                                    <tr>
                                        <td>@user.UserID</td>
                                        <td>@user.FullName</td>
                                        <td>@user.Username</td>
                                        <td><span class="badge bg-primary">@user.Role?.RoleName</span></td>
                                        <td>@user.Email</td>
                                        <td>
                                            @if (user.IsActive)
                                            {
                                                <span class="badge bg-success">Ho·∫°t ƒë·ªông</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-danger">Kh√¥ng ho·∫°t ƒë·ªông</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @if (Model.RecentBorrows != null && Model.RecentBorrows.Any())
    {
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>üìö M∆∞·ª£n s√°ch g·∫ßn ƒë√¢y</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>Ng√†y m∆∞·ª£n</th>
                                        <th>Ng∆∞·ªùi m∆∞·ª£n</th>
                                        <th>S√°ch</th>
                                        <th>H·∫°n tr·∫£</th>
                                        <th>Tr·∫°ng th√°i</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var borrow in Model.RecentBorrows.Take(10))
                                    {
                                        <tr>
                                            <td>@borrow.BorrowDate.ToString("dd/MM/yyyy")</td>
                                            <td>@borrow.User?.FullName</td>
                                            <td>@borrow.BookCopy?.Book?.Title</td>
                                            <td>@borrow.DueDate.ToString("dd/MM/yyyy")</td>
                                            <td>
                                                @if (borrow.IsReturned)
                                                {
                                                    <span class="badge bg-success">ƒê√£ tr·∫£</span>
                                                }
                                                else if (borrow.DueDate < DateTime.Now.Date)
                                                {
                                                    <span class="badge bg-danger">Qu√° h·∫°n</span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-warning">ƒêang m∆∞·ª£n</span>
                                                }
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

